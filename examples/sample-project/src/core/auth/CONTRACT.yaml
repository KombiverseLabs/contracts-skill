# CONTRACT.yaml - Technical specification derived from CONTRACT.md
# This file is auto-synced with CONTRACT.md.

meta:
  source_hash: "sha256:a621ae7f9964dec96ac2ab7cf41bf0a6137832ec183ea4789a3433258419168a"
  last_sync: "2026-02-28T12:00:00Z"
  tier: core
  version: "1.1"

module:
  name: "auth"
  type: "core"
  path: "src/core/auth"

features:
  - id: "email-password-login"
    description: "Email/password login"
    status: implemented
    entry_point: "./login.ts"
    tests: "./login.test.ts"

  - id: "session-tokens"
    description: "Session tokens with automatic refresh"
    status: implemented
    entry_point: "./session.ts"
    tests: "./session.test.ts"

  - id: "oauth2-integration"
    description: "OAuth2 integration (Google, GitHub)"
    status: planned
    notes: "Waiting for OAuth app credentials"

  - id: "password-reset"
    description: "Password reset via email"
    status: planned

constraints:
  must:
    - "Use bcrypt with cost factor 12 for password hashing"
    - "Expire sessions after 24 hours of inactivity"
    - "Use HTTP-only cookies for session tokens"
  must_not:
    - "Store passwords in plain text"
    - "Log sensitive authentication data"

relationships:
  depends_on: []
  consumed_by:
    - "src/features/dashboard"

validation:
  exports: ["login", "logout", "refreshSession", "validateSession"]
  test_pattern: "*.test.ts"
  custom_script: null

verification_tests:
  - id: "VT-1"
    name: "Full auth round-trip with credential verification"
    status: passing
    test_file: "./auth.vt.test.ts"
    last_run: "2026-02-28T12:00:00Z"
    last_result: pass

attestation:
  contract_version: "1.1"
  last_verified: "2026-02-28T12:00:00Z"
  verification_tests_pass: true
  features_implemented: ["email-password-login", "session-tokens"]
  confidence: high
  next_review: "2026-03-30T12:00:00Z"

changelog:
  - date: "2026-02-28"
    version: "1.1"
    change: "Added verification tests and attestation; updated success criteria"
    author: "system"
  - date: "2026-01-29"
    version: "1.0"
    change: "Initial contract"
    author: "system"
